* 엑셀 대체하기

** 피벗 테이블

 - 빈도 분석
 - 비율 계산

#+BEGIN_SRC ipython :session :exports both :results raw
%matplotlib inline
import pandas as pd

df = pd.read_excel('assets/엑셀과정실습생.xlsx', sheet_name='Sheet1')
df
#+END_SRC

#+RESULTS:
#+BEGIN_EXAMPLE
    번호  나이  성별  신장(cm)  몸무게(kg)  즐기는 음식
  0    1  30   1     183       82       1
  1    2  28   2     160       62       3
  2    3  27   1     178       77       2
  3    4  23   1     172       70       2
  4    5  25   1     168       72       3
  5    6  27   1     179       77       1
  6    7  26   1     169       71       1
  7    8  29   1     171       75       3
  8    9  34   2     158       60       2
  9   10  31   1     183       77       3
  10  11  26   2     162       59       1
  11  12  26   1     173       70       2
  12  13  35   1     173       68       3
  13  14  24   1     176       66       3
  14  15  29   2     170       70       2
  15  16  33   1     177       72       2
  16  17  38   2     159       55       1
  17  18  26   1     166       69       3
  18  19  26   1     169       66       2
  19  20  28   2     159       60       2
#+END_EXAMPLE


#+BEGIN_SRC ipython :session :exports both :results raw
pd.value_counts(df['성별'], normalize=True)
#+END_SRC

#+RESULTS:
#+BEGIN_EXAMPLE
  1    0.7
  2    0.3
  Name: 성별, dtype: float64
#+END_EXAMPLE


#+BEGIN_SRC ipython :session :exports both :results raw
pd.pivot_table(df, index='성별')
#+END_SRC

#+RESULTS:
#+BEGIN_EXAMPLE
             나이    몸무게(kg)         번호      신장(cm)    즐기는 음식
  성별                                                       
  1   27.714286  72.285714   9.714286  174.071429  2.214286
  2   30.500000  61.000000  12.333333  161.333333  1.833333
#+END_EXAMPLE


#+BEGIN_SRC ipython :session :exports both :results raw
pd.pivot_table(df, index='성별', columns='즐기는 음식', values='몸무게(kg)')
#+END_SRC

#+RESULTS:
#+BEGIN_EXAMPLE
  즐기는 음식          1          2          3
  성별                                     
  1       76.666667  71.000000  71.166667
  2       57.000000  63.333333  62.000000
#+END_EXAMPLE

** 그래프 그리기


#+BEGIN_SRC ipython :session :exports none
  %matplotlib inline

  import matplotlib
  import matplotlib.font_manager as fm

  matplotlib.rc('font', family='Noto Sans CJK KR')
#+END_SRC

#+BEGIN_SRC ipython :session :exports both :results raw :ipyfile outputs/excel-1-plot1.png
  df.plot();
#+END_SRC

#+RESULTS:
[[file:outputs/excel-1-plot1.png]]


** 컬럼 추가, 변형

 - 날짜 범주화, 연령대 범주화

** Row 필터링
